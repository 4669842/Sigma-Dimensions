@Kopernicus:FOR[SigDim2]
{
	@Body,*
	{
		@Atmosphere:HAS[#atmosphereDepth[*]]
		{
			%altitude = #$atmosphereDepth$
			%maxAltitude = #$atmosphereDepth$
		}
		@Atmosphere:HAS[#altitude[*],~atmosphereDepth[*]]
		{
			%maxAltitude = #$altitude$
			%atmosphereDepth = #$altitude$
		}
		@Atmosphere:HAS[#maxAltitude[*],~altitude[*],~atmosphereDepth[*]]
		{
			%altitude = #$maxAltitude$
			%atmosphereDepth = #$maxAltitude$
		}
		@Atmosphere
		{
			@maxAltitude *= #$../SigmaDimensions/Atmosphere$
			@altitude *= #$../SigmaDimensions/Atmosphere$
			@atmosphereDepth *= #$../SigmaDimensions/Atmosphere$
			
			// temperature ASL
			
			@temperatureSeaLevel *= #$../SigmaDimensions/tempASL$
			
			// pressure ASL
			
			@staticPressureASL *= #$../SigmaDimensions/atmoASL$
			
			@pressureCurve
			{
				@key,* ^= :$: 0 0 0 x:
				@key,*[1, ] *= #$../../SigmaDimensions/atmoASL$
				@key,*[2, ] *= #$../../SigmaDimensions/atmoASL$
				@key,*[3, ] *= #$../../SigmaDimensions/atmoASL$
				@key,* ^= : 0 0 0 x$: :
			}
			
			@temperatureCurve
			{
				@key,* ^= :$: 0 0 0 x:
				@key,*[1, ] *= #$../../SigmaDimensions/tempASL$
				@key,*[2, ] *= #$../../SigmaDimensions/tempASL$
				@key,*[3, ] *= #$../../SigmaDimensions/tempASL$
				@key,* ^= : 0 0 0 x$: :
			}
		}
		@Atmosphere:HAS[~addAFG[False]]
		{
			%AtmosphereFromGround
			{
				&innerRadiusMult = 0.975
				&outerRadiusMult = 1.025
			}
			@AtmosphereFromGround:HAS[~outerRadius[*]]
			{
				outerRadius = #$../../Properties/radius$
				@outerRadius *= #$outerRadiusMult$
			}
			@AtmosphereFromGround:HAS[~innerRadius[*]]
			{
				innerRadius = #$outerRadius$
				@innerRadius *= #$innerRadiusMult$
			}
			@AtmosphereFromGround:HAS[#transformScale[*]]
			{
				@transformScale ^= : ::
				@transformScale ^= :	::
			}
			@AtmosphereFromGround:HAS[#transformScale[0,0,0]]
			{
				%removeAFG = True
			}
			@AtmosphereFromGround:HAS[~removeAFG[True]]
			{
				// inner radius
				@innerRadius -= #$../../Properties/radius$
				@innerRadius *= #$../../SigmaDimensions/Atmosphere$
				@innerRadius *= #$../../SigmaDimensions/atmoVisualEffect$
				@innerRadius /= #$../../SigmaDimensions/Resize$
				@innerRadius += #$../../Properties/radius$
				@innerRadius *= #$../../SigmaDimensions/Resize$
				
				// outer radius
				@outerRadius -= #$../../Properties/radius$
				@outerRadius *= #$../../SigmaDimensions/Atmosphere$
				@outerRadius *= #$../../SigmaDimensions/atmoVisualEffect$
				%transformScale = #$outerRadius$
				@outerRadius /= #$../../SigmaDimensions/Resize$
				@outerRadius += #$../../Properties/radius$
				@outerRadius *= #$../../SigmaDimensions/Resize$
				!innerRadiusMult,* = DEL
				!outerRadiusMult,* = DEL
			}
			@AtmosphereFromGround:HAS[~removeAFG[True],#transformScale[<6000]]
			{
				@transformScale = 6000
			}
			@AtmosphereFromGround:HAS[~removeAFG[True]]
			{
				@transformScale *= 2
				@transformScale /= #$../../Properties/radius$
				@transformScale /= #$../../SigmaDimensions/Resize$
				@transformScale += 1
				@transformScale = #$transformScale$,$transformScale$,$transformScale$
			}
			@AtmosphereFromGround:HAS[#removeAFG[True]]
			{
				%transformScale = 0,0,0
				!removeAFG = DEL
			}
		}	
		@Atmosphere:HAS[~pressureCurveIsNormalized[True]]
		{
			// pressureCurve
			
			@pressureCurve
			{
				@key,* ^= :$: 0 0 0 x:
				@key,*[0, ] *= #$../../SigmaDimensions/Atmosphere$
				@key,*[2, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,*[3, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,* ^= : 0 0 0 x$: :
			}
		}
		@Atmosphere:HAS[~temperatureCurveIsNormalized[True]]
		{
			// temperatureCurve
			
			@temperatureCurve
			{
				@key,* ^= :$: 0 0 0 x:
				@key,*[0, ] *= #$../../SigmaDimensions/Atmosphere$
				@key,*[2, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,*[3, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,* ^= : 0 0 0 x$: :
			}
		}
		@Atmosphere
		{
			// temperatureSunMultCurve
			
			@temperatureSunMultCurve
			{
				@key,* ^= :$: 0 0 0 x:
				@key,*[0, ] *= #$../../SigmaDimensions/Atmosphere$
				@key,*[2, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,*[3, ] /= #$../../SigmaDimensions/Atmosphere$
				@key,* ^= : 0 0 0 x$: :
			}
		}
	}
	@Body[Kerbin]
	{
		@Atmosphere
		{
			// ISP fix
			@pressureCurve
			{
				@key,*[0, ] += 0.0001
				key,0 = 0 101.325
			}
		}
	}
}
