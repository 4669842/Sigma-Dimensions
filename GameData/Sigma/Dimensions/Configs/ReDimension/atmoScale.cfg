@Kopernicus:AFTER[SigDim]
{
	@Body,*
	{
		@Atmosphere:HAS[!AtmosphereFromGround:HAS[#innerRadius[*]]]
		{
			%AtmosphereFromGround
			{
				innerRadiusMult = 0.999375
			}
		}
		@Atmosphere:HAS[!AtmosphereFromGround:HAS[#outerRadius[*]]]
		{
			%AtmosphereFromGround
			{
				outerRadiusMult = 1.025
			}
		}
		@Atmosphere:HAS[#atmosphereDepth[*]]
		{
			%altitude = #$atmosphereDepth$
			%maxAltitude = #$atmosphereDepth$
		}
		@Atmosphere:HAS[#altitude[*],~atmosphereDepth[*]]
		{
			%maxAltitude = #$altitude$
			%atmosphereDepth = #$altitude$
		}
		@Atmosphere:HAS[#maxAltitude[*],~altitude[*],~atmosphereDepth[*]]
		{
			%altitude = #$maxAltitude$
			%atmosphereDepth = #$maxAltitude$
		}
		@Atmosphere
		{
			@maxAltitude *= #$@SigmaDimensions/Atmosphere$
			@altitude *= #$@SigmaDimensions/Atmosphere$
			@atmosphereDepth *= #$@SigmaDimensions/Atmosphere$
			%AtmosphereFromGround {}
			@AtmosphereFromGround:HAS[~innerRadius[*]]
			{
				innerRadius = #$../../Properties/radius$
				@innerRadius *= #$innerRadiusMult$
			}
			@AtmosphereFromGround:HAS[~outerRadius[*]]
			{
				outerRadius = #$../../Properties/radius$
				@outerRadius *= #$outerRadiusMult$
			}
			@AtmosphereFromGround:HAS[~sunAtmo[True]]
			{
				@outerRadius -= #$../../Properties/radius$
				@outerRadius *= #$@SigmaDimensions/Atmosphere$
				%transformScale = #$outerRadius$
				@transformScale *= #$@SigmaDimensions/atmoVisualEffect$
				@innerRadius *= #$@SigmaDimensions/Resize$
				@outerRadius /= #$@SigmaDimensions/Resize$
				@outerRadius += #$../../Properties/radius$
				@outerRadius *= #$@SigmaDimensions/Resize$
				!innerRadiusMult,* = DEL
				!outerRadiusMult,* = DEL
			}
			@AtmosphereFromGround:HAS[#transformScale[<6000]]
			{
				@transformScale = 6000
			}
			@AtmosphereFromGround:HAS[~sunAtmo[True]]
			{
				@transformScale /= #$../../Properties/radius$
				@transformScale /= #$@SigmaDimensions/Resize$
				@transformScale += 1
				@transformScale = #$transformScale$,$transformScale$,$transformScale$
			}
			@AtmosphereFromGround:HAS[#sunAtmo[True]]
			{
				!sunAtmo = DEL
				%transformScale = 0,0,0
			}
		}	
		@Atmosphere:HAS[~pressureCurveIsNormalized[True]]
		{
			// pressureCurve
			
			@pressureCurve
			{
				@key,* ^= : :,:
				@key,*[0] *= #$@SigmaDimensions/Atmosphere$
			}
			@pressureCurve:HAS[#key[*,*,*,*]]
			{
				@key,*[2] /= #$@SigmaDimensions/Atmosphere$
				@key,*[3] /= #$@SigmaDimensions/Atmosphere$
			}
			@pressureCurve
			{
				@key,* ^= :,: :
			}
		}
		@Atmosphere:HAS[~temperatureCurveIsNormalized[True]]
		{
			// temperatureCurve
			
			@temperatureCurve
			{
				@key,* ^= : :,:
				@key,*[0] *= #$@SigmaDimensions/Atmosphere$
			}
			@temperatureCurve:HAS[#key[*,*,*,*]]
			{
				@key,*[2] /= #$@SigmaDimensions/Atmosphere$
				@key,*[3] /= #$@SigmaDimensions/Atmosphere$
			}
			@temperatureCurve
			{
				@key,* ^= :,: :
			}
		}
		@Atmosphere
		{
			// temperatureSunMultCurve
			
			@temperatureSunMultCurve
			{
				@key,* ^= : :,:
				@key,*[0] *= #$@SigmaDimensions/Atmosphere$
			}
			@temperatureSunMultCurve:HAS[#key[*,*,*,*]]
			{
				@key,*[2] /= #$@SigmaDimensions/Atmosphere$
				@key,*[3] /= #$@SigmaDimensions/Atmosphere$
			}
			@temperatureSunMultCurve
			{
				@key,* ^= :,: :
			}
		}
	}
}
